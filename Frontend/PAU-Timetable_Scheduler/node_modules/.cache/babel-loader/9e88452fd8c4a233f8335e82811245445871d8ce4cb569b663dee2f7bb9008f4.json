{"ast":null,"code":"import axios from 'axios';\n\n// Determine API base URL based on environment\nconst getApiBaseUrl = () => {\n  // For Hugging Face Spaces, use the current domain\n  if (window.location.hostname.includes('hf.space') || window.location.hostname.includes('huggingface.co')) {\n    return window.location.origin;\n  }\n  // For local development\n  return process.env.REACT_APP_API_BASE_URL || 'http://127.0.0.1:7860';\n};\nconst API_BASE_URL = getApiBaseUrl();\n\n// Create axios instance with CORS-friendly config\nconst apiClient = axios.create({\n  baseURL: API_BASE_URL,\n  timeout: 300000,\n  // 5 minutes timeout for large file processing\n  withCredentials: false,\n  // Important for CORS\n  headers: {\n    'Accept': 'application/json',\n    'Content-Type': 'application/json'\n  }\n});\n\n// Add request interceptor for logging and CORS handling\napiClient.interceptors.request.use(config => {\n  console.log(`Making ${config.method.toUpperCase()} request to ${config.url}`);\n\n  // Set appropriate headers for different request types\n  if (config.data instanceof FormData) {\n    // For file uploads, let browser set Content-Type with boundary\n    delete config.headers['Content-Type'];\n  } else if (typeof config.data === 'object' && config.data !== null) {\n    // For JSON data\n    config.headers['Content-Type'] = 'application/json';\n  }\n\n  // Add CORS headers\n  config.headers['Access-Control-Allow-Origin'] = '*';\n  config.headers['Access-Control-Allow-Methods'] = 'GET, POST, PUT, DELETE, OPTIONS';\n  config.headers['Access-Control-Allow-Headers'] = 'Origin, X-Requested-With, Content-Type, Accept, Authorization';\n  return config;\n}, error => {\n  console.error('Request error:', error);\n  return Promise.reject(error);\n});\n\n// Add response interceptor for error handling\napiClient.interceptors.response.use(response => {\n  return response;\n}, error => {\n  console.error('API Error:', error);\n  if (error.response) {\n    // Server responded with error status\n    const {\n      status,\n      data\n    } = error.response;\n\n    // Handle CORS-specific errors\n    if (status === 0 || error.message.includes('CORS') || error.message.includes('Network Error')) {\n      throw new Error('CORS error: Please ensure the backend is properly configured for cross-origin requests.');\n    }\n    const message = (data === null || data === void 0 ? void 0 : data.message) || (data === null || data === void 0 ? void 0 : data.error) || `Server error (${status})`;\n    throw new Error(message);\n  } else if (error.request) {\n    // Request was made but no response received\n    if (error.message.includes('CORS') || error.code === 'ERR_NETWORK') {\n      throw new Error('CORS policy blocked the request. Please check backend CORS configuration.');\n    }\n    throw new Error('Unable to connect to the server. Please check your internet connection.');\n  } else {\n    // Something else happened\n    throw new Error(error.message || 'An unexpected error occurred');\n  }\n});\n\n/**\r\n * Make a CORS-safe request with retry logic\r\n * @param {Function} requestFn - The axios request function\r\n * @param {number} retries - Number of retries\r\n */\nconst makeRequestWithRetry = async (requestFn, retries = 3) => {\n  for (let i = 0; i < retries; i++) {\n    try {\n      return await requestFn();\n    } catch (error) {\n      if (i === retries - 1) throw error;\n\n      // If CORS error, wait and retry\n      if (error.message.includes('CORS') || error.message.includes('Network Error')) {\n        console.log(`CORS error, retrying... (${i + 1}/${retries})`);\n        await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));\n      } else {\n        throw error;\n      }\n    }\n  }\n};\n\n/**\r\n * Upload file to the server with CORS handling\r\n * @param {File} file - The Excel file to upload\r\n * @returns {Promise<Object>} Response containing file ID and metadata\r\n */\nexport const uploadFile = async file => {\n  const formData = new FormData();\n  formData.append('file', file);\n  formData.append('filename', file.name);\n  const uploadEndpoint = process.env.REACT_APP_UPLOAD_ENDPOINT || '/upload-excel';\n  try {\n    const response = await makeRequestWithRetry(() => apiClient.post(uploadEndpoint, formData, {\n      headers: {\n        // Let browser set Content-Type for FormData\n      }\n    }));\n\n    // Server should return JSON like: { upload_id: \"uuid-1234\", filename: \"...\", status: \"uploaded\" }\n    const data = response.data;\n    const uploadId = data.upload_id || data.uploadId || data.id; // defensive read\n    if (!uploadId) throw new Error('upload_id not returned by server');\n    console.log('Upload successful:', data);\n    // return full server response if you want metadata, but the uploadId is essential\n    return {\n      uploadId,\n      meta: data\n    };\n  } catch (err) {\n    var _err$response, _err$response$data;\n    console.error('Upload error details:', err);\n    const message = (err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || err.message || 'Upload failed';\n    throw new Error(`File upload failed: ${message}`);\n  }\n};\n\n/**\r\n * Generate timetable from uploaded file\r\n * @param {string} uploadId - ID of the uploaded file\r\n * @param {Function} progressCallback - Callback for progress updates\r\n * @returns {Promise<Object>} Generated timetable data\r\n */\nexport const generateTimetable = async (uploadId, progressCallback) => {\n  try {\n    // Start the generation process\n    const body = {\n      upload_id: uploadId,\n      config: {\n        population_size: 50,\n        max_generations: 40,\n        F: 0.4,\n        CR: 0.9\n      }\n    };\n    console.log('Starting timetable generation with:', body);\n    const startResponse = await makeRequestWithRetry(() => apiClient.post('/generate-timetable', body));\n    if (startResponse.status !== 202) {\n      throw new Error('Failed to start timetable generation');\n    }\n    console.log('Generation started, polling for status...');\n    // Poll for status updates\n    return await pollForCompletion(uploadId, progressCallback);\n  } catch (error) {\n    var _error$response, _error$response$data;\n    console.error('Generation error:', error);\n    const msg = (error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || (error === null || error === void 0 ? void 0 : error.message) || 'Unknown error';\n    throw new Error(`Timetable generation failed: ${msg}`);\n  }\n};\n\n/**\r\n * Poll the server for generation completion status with CORS handling\r\n * @param {string} uploadId - Upload ID to check status for\r\n * @param {Function} progressCallback - Progress update callback\r\n * @returns {Promise<Object>} Final timetable data\r\n */\nconst pollForCompletion = async (uploadId, progressCallback) => {\n  const maxAttempts = 120; // 10 minutes with 5-second intervals\n  let attempts = 0;\n  return new Promise((resolve, reject) => {\n    const checkStatus = async () => {\n      try {\n        attempts++;\n        const statusResponse = await makeRequestWithRetry(() => apiClient.get(`/get-timetable-status/${uploadId}`));\n        const statusData = statusResponse.data;\n        console.log(`Status check ${attempts}:`, statusData.status, statusData.progress);\n\n        // Update progress if callback provided\n        if (progressCallback) {\n          progressCallback({\n            percentage: statusData.progress || 0,\n            message: statusData.message || 'Processing...'\n          });\n        }\n        if (statusData.status === 'completed') {\n          // Generation completed successfully\n          console.log('Generation completed successfully');\n          const result = statusData.result;\n\n          // Transform the data to ensure it's in the expected format\n          if (result) {\n            // Ensure timetables array exists and has proper format\n            if (!result.timetables && result.timetables_raw) {\n              result.timetables = result.timetables_raw;\n            }\n\n            // If we have parsed_timetables, use those to enhance timetables data\n            if (result.parsed_timetables && result.timetables) {\n              result.timetables = result.timetables.map((timetable, index) => {\n                const parsed = result.parsed_timetables[index];\n                return {\n                  ...timetable,\n                  rows: parsed ? parsed.rows : []\n                };\n              });\n            }\n          }\n          resolve(result);\n          return;\n        }\n        if (statusData.status === 'error') {\n          // Generation failed\n          console.error('Generation failed:', statusData.error);\n          reject(new Error(statusData.error || 'Generation failed'));\n          return;\n        }\n        if (statusData.status === 'processing') {\n          // Still processing, continue polling\n          if (attempts >= maxAttempts) {\n            reject(new Error('Generation timeout - please try again'));\n            return;\n          }\n\n          // Poll again in 5 seconds\n          setTimeout(checkStatus, 5000);\n          return;\n        }\n\n        // Unknown status\n        reject(new Error(`Unknown status: ${statusData.status}`));\n      } catch (error) {\n        console.error('Status check error:', error);\n\n        // If it's a CORS error, provide helpful message\n        if (error.message.includes('CORS')) {\n          reject(new Error('CORS policy is blocking requests to the backend. Please check the server configuration.'));\n        } else {\n          reject(error);\n        }\n      }\n    };\n\n    // Start polling\n    checkStatus();\n  });\n};\n\n/**\r\n * Download generated timetable in specified format with CORS handling\r\n * @param {string} uploadId - The upload ID from the generation process\r\n * @param {string} format - Download format ('excel', 'pdf')\r\n * @returns {Promise<void>}\r\n */\nexport const downloadTimetable = async (uploadId, format) => {\n  try {\n    console.log(`Downloading timetable: ${uploadId} in ${format} format`);\n    const response = await makeRequestWithRetry(() => apiClient.post('/export-timetable', {\n      upload_id: uploadId,\n      format: format.toLowerCase()\n    }, {\n      responseType: 'blob' // Important for file downloads\n    }));\n\n    // Create blob link to download\n    const url = window.URL.createObjectURL(new Blob([response.data]));\n    const link = document.createElement('a');\n    link.href = url;\n\n    // Set filename based on format\n    const timestamp = new Date().toISOString().slice(0, 10);\n    const filename = `timetable_${timestamp}.${format === 'pdf' ? 'pdf' : 'xlsx'}`;\n    link.setAttribute('download', filename);\n\n    // Trigger download\n    document.body.appendChild(link);\n    link.click();\n    link.remove();\n    window.URL.revokeObjectURL(url);\n  } catch (error) {\n    console.error('Download error:', error);\n    throw new Error(`Download failed: ${error.message}`);\n  }\n};\n\n/**\r\n * Get available time slots from server\r\n * @returns {Promise<Array>} Available time slots\r\n */\nexport const getTimeSlots = async () => {\n  try {\n    // Try to get time slots from API first\n    const response = await makeRequestWithRetry(() => apiClient.get('/timetable/timeslots'));\n    return response.data;\n  } catch (error) {\n    // If API endpoint doesn't exist or fails, return default time slots\n    console.warn('Failed to fetch time slots from API, using defaults:', error.message);\n    return [{\n      start: '09:00',\n      end: '10:00',\n      label: '9:00 AM'\n    }, {\n      start: '10:00',\n      end: '11:00',\n      label: '10:00 AM'\n    }, {\n      start: '11:00',\n      end: '12:00',\n      label: '11:00 AM'\n    }, {\n      start: '12:00',\n      end: '13:00',\n      label: '12:00 PM'\n    }, {\n      start: '14:00',\n      end: '15:00',\n      label: '2:00 PM'\n    }, {\n      start: '15:00',\n      end: '16:00',\n      label: '3:00 PM'\n    }, {\n      start: '16:00',\n      end: '17:00',\n      label: '4:00 PM'\n    }];\n  }\n};\n\n/**\r\n * Validate uploaded file on server\r\n * @param {string} fileId - ID of uploaded file\r\n * @returns {Promise<Object>} Validation results\r\n */\nexport const validateFile = async fileId => {\n  try {\n    const response = await makeRequestWithRetry(() => apiClient.post('/timetable/validate', {\n      fileId\n    }));\n    return response.data;\n  } catch (error) {\n    throw new Error(`File validation failed: ${error.message}`);\n  }\n};\nexport default apiClient;","map":{"version":3,"names":["axios","getApiBaseUrl","window","location","hostname","includes","origin","process","env","REACT_APP_API_BASE_URL","API_BASE_URL","apiClient","create","baseURL","timeout","withCredentials","headers","interceptors","request","use","config","console","log","method","toUpperCase","url","data","FormData","error","Promise","reject","response","status","message","Error","code","makeRequestWithRetry","requestFn","retries","i","resolve","setTimeout","uploadFile","file","formData","append","name","uploadEndpoint","REACT_APP_UPLOAD_ENDPOINT","post","uploadId","upload_id","id","meta","err","_err$response","_err$response$data","generateTimetable","progressCallback","body","population_size","max_generations","F","CR","startResponse","pollForCompletion","_error$response","_error$response$data","msg","maxAttempts","attempts","checkStatus","statusResponse","get","statusData","progress","percentage","result","timetables","timetables_raw","parsed_timetables","map","timetable","index","parsed","rows","downloadTimetable","format","toLowerCase","responseType","URL","createObjectURL","Blob","link","document","createElement","href","timestamp","Date","toISOString","slice","filename","setAttribute","appendChild","click","remove","revokeObjectURL","getTimeSlots","warn","start","end","label","validateFile","fileId"],"sources":["C:/Users/Jamil/Downloads/Timetable Scheduler Combined/SEPT 13 FRONTEND HOSTER/PAU-Timetable_Scheduler/src/services/api.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n// Determine API base URL based on environment\r\nconst getApiBaseUrl = () => {\r\n  // For Hugging Face Spaces, use the current domain\r\n  if (window.location.hostname.includes('hf.space') || window.location.hostname.includes('huggingface.co')) {\r\n    return window.location.origin;\r\n  }\r\n  // For local development\r\n  return process.env.REACT_APP_API_BASE_URL || 'http://127.0.0.1:7860';\r\n};\r\n\r\nconst API_BASE_URL = getApiBaseUrl();\r\n\r\n// Create axios instance with CORS-friendly config\r\nconst apiClient = axios.create({\r\n  baseURL: API_BASE_URL,\r\n  timeout: 300000, // 5 minutes timeout for large file processing\r\n  withCredentials: false, // Important for CORS\r\n  headers: {\r\n    'Accept': 'application/json',\r\n    'Content-Type': 'application/json',\r\n  },\r\n});\r\n\r\n// Add request interceptor for logging and CORS handling\r\napiClient.interceptors.request.use(\r\n  (config) => {\r\n    console.log(`Making ${config.method.toUpperCase()} request to ${config.url}`);\r\n    \r\n    // Set appropriate headers for different request types\r\n    if (config.data instanceof FormData) {\r\n      // For file uploads, let browser set Content-Type with boundary\r\n      delete config.headers['Content-Type'];\r\n    } else if (typeof config.data === 'object' && config.data !== null) {\r\n      // For JSON data\r\n      config.headers['Content-Type'] = 'application/json';\r\n    }\r\n    \r\n    // Add CORS headers\r\n    config.headers['Access-Control-Allow-Origin'] = '*';\r\n    config.headers['Access-Control-Allow-Methods'] = 'GET, POST, PUT, DELETE, OPTIONS';\r\n    config.headers['Access-Control-Allow-Headers'] = 'Origin, X-Requested-With, Content-Type, Accept, Authorization';\r\n    \r\n    return config;\r\n  },\r\n  (error) => {\r\n    console.error('Request error:', error);\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Add response interceptor for error handling\r\napiClient.interceptors.response.use(\r\n  (response) => {\r\n    return response;\r\n  },\r\n  (error) => {\r\n    console.error('API Error:', error);\r\n    \r\n    if (error.response) {\r\n      // Server responded with error status\r\n      const { status, data } = error.response;\r\n      \r\n      // Handle CORS-specific errors\r\n      if (status === 0 || error.message.includes('CORS') || error.message.includes('Network Error')) {\r\n        throw new Error('CORS error: Please ensure the backend is properly configured for cross-origin requests.');\r\n      }\r\n      \r\n      const message = data?.message || data?.error || `Server error (${status})`;\r\n      throw new Error(message);\r\n    } else if (error.request) {\r\n      // Request was made but no response received\r\n      if (error.message.includes('CORS') || error.code === 'ERR_NETWORK') {\r\n        throw new Error('CORS policy blocked the request. Please check backend CORS configuration.');\r\n      }\r\n      throw new Error('Unable to connect to the server. Please check your internet connection.');\r\n    } else {\r\n      // Something else happened\r\n      throw new Error(error.message || 'An unexpected error occurred');\r\n    }\r\n  }\r\n);\r\n\r\n/**\r\n * Make a CORS-safe request with retry logic\r\n * @param {Function} requestFn - The axios request function\r\n * @param {number} retries - Number of retries\r\n */\r\nconst makeRequestWithRetry = async (requestFn, retries = 3) => {\r\n  for (let i = 0; i < retries; i++) {\r\n    try {\r\n      return await requestFn();\r\n    } catch (error) {\r\n      if (i === retries - 1) throw error;\r\n      \r\n      // If CORS error, wait and retry\r\n      if (error.message.includes('CORS') || error.message.includes('Network Error')) {\r\n        console.log(`CORS error, retrying... (${i + 1}/${retries})`);\r\n        await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));\r\n      } else {\r\n        throw error;\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Upload file to the server with CORS handling\r\n * @param {File} file - The Excel file to upload\r\n * @returns {Promise<Object>} Response containing file ID and metadata\r\n */\r\nexport const uploadFile = async (file) => {\r\n  const formData = new FormData();\r\n  formData.append('file', file);\r\n  formData.append('filename', file.name);\r\n\r\n  const uploadEndpoint = process.env.REACT_APP_UPLOAD_ENDPOINT || '/upload-excel';\r\n\r\n  try {\r\n    const response = await makeRequestWithRetry(() => \r\n      apiClient.post(uploadEndpoint, formData, {\r\n        headers: {\r\n          // Let browser set Content-Type for FormData\r\n        }\r\n      })\r\n    );\r\n\r\n    // Server should return JSON like: { upload_id: \"uuid-1234\", filename: \"...\", status: \"uploaded\" }\r\n    const data = response.data;\r\n    const uploadId = data.upload_id || data.uploadId || data.id; // defensive read\r\n    if (!uploadId) throw new Error('upload_id not returned by server');\r\n\r\n    console.log('Upload successful:', data);\r\n    // return full server response if you want metadata, but the uploadId is essential\r\n    return { uploadId, meta: data };\r\n  } catch (err) {\r\n    console.error('Upload error details:', err);\r\n    const message = err?.response?.data?.error || err.message || 'Upload failed';\r\n    throw new Error(`File upload failed: ${message}`);\r\n  }\r\n};\r\n\r\n/**\r\n * Generate timetable from uploaded file\r\n * @param {string} uploadId - ID of the uploaded file\r\n * @param {Function} progressCallback - Callback for progress updates\r\n * @returns {Promise<Object>} Generated timetable data\r\n */\r\nexport const generateTimetable = async (uploadId, progressCallback) => {\r\n  try {\r\n    // Start the generation process\r\n    const body = {\r\n      upload_id: uploadId,\r\n      config: {\r\n        population_size: 50,\r\n        max_generations: 40,\r\n        F: 0.4,\r\n        CR: 0.9\r\n      }\r\n    };\r\n\r\n    console.log('Starting timetable generation with:', body);\r\n    const startResponse = await makeRequestWithRetry(() =>\r\n      apiClient.post('/generate-timetable', body)\r\n    );\r\n\r\n    if (startResponse.status !== 202) {\r\n      throw new Error('Failed to start timetable generation');\r\n    }\r\n\r\n    console.log('Generation started, polling for status...');\r\n    // Poll for status updates\r\n    return await pollForCompletion(uploadId, progressCallback);\r\n\r\n  } catch (error) {\r\n    console.error('Generation error:', error);\r\n    const msg = error?.response?.data?.error || error?.message || 'Unknown error';\r\n    throw new Error(`Timetable generation failed: ${msg}`);\r\n  }\r\n};\r\n\r\n/**\r\n * Poll the server for generation completion status with CORS handling\r\n * @param {string} uploadId - Upload ID to check status for\r\n * @param {Function} progressCallback - Progress update callback\r\n * @returns {Promise<Object>} Final timetable data\r\n */\r\nconst pollForCompletion = async (uploadId, progressCallback) => {\r\n  const maxAttempts = 120; // 10 minutes with 5-second intervals\r\n  let attempts = 0;\r\n\r\n  return new Promise((resolve, reject) => {\r\n    const checkStatus = async () => {\r\n      try {\r\n        attempts++;\r\n        \r\n        const statusResponse = await makeRequestWithRetry(() =>\r\n          apiClient.get(`/get-timetable-status/${uploadId}`)\r\n        );\r\n        const statusData = statusResponse.data;\r\n        \r\n        console.log(`Status check ${attempts}:`, statusData.status, statusData.progress);\r\n        \r\n        // Update progress if callback provided\r\n        if (progressCallback) {\r\n          progressCallback({\r\n            percentage: statusData.progress || 0,\r\n            message: statusData.message || 'Processing...'\r\n          });\r\n        }\r\n\r\n        if (statusData.status === 'completed') {\r\n          // Generation completed successfully\r\n          console.log('Generation completed successfully');\r\n          const result = statusData.result;\r\n          \r\n          // Transform the data to ensure it's in the expected format\r\n          if (result) {\r\n            // Ensure timetables array exists and has proper format\r\n            if (!result.timetables && result.timetables_raw) {\r\n              result.timetables = result.timetables_raw;\r\n            }\r\n            \r\n            // If we have parsed_timetables, use those to enhance timetables data\r\n            if (result.parsed_timetables && result.timetables) {\r\n              result.timetables = result.timetables.map((timetable, index) => {\r\n                const parsed = result.parsed_timetables[index];\r\n                return {\r\n                  ...timetable,\r\n                  rows: parsed ? parsed.rows : []\r\n                };\r\n              });\r\n            }\r\n          }\r\n          \r\n          resolve(result);\r\n          return;\r\n        }\r\n        \r\n        if (statusData.status === 'error') {\r\n          // Generation failed\r\n          console.error('Generation failed:', statusData.error);\r\n          reject(new Error(statusData.error || 'Generation failed'));\r\n          return;\r\n        }\r\n        \r\n        if (statusData.status === 'processing') {\r\n          // Still processing, continue polling\r\n          if (attempts >= maxAttempts) {\r\n            reject(new Error('Generation timeout - please try again'));\r\n            return;\r\n          }\r\n          \r\n          // Poll again in 5 seconds\r\n          setTimeout(checkStatus, 5000);\r\n          return;\r\n        }\r\n        \r\n        // Unknown status\r\n        reject(new Error(`Unknown status: ${statusData.status}`));\r\n        \r\n      } catch (error) {\r\n        console.error('Status check error:', error);\r\n        \r\n        // If it's a CORS error, provide helpful message\r\n        if (error.message.includes('CORS')) {\r\n          reject(new Error('CORS policy is blocking requests to the backend. Please check the server configuration.'));\r\n        } else {\r\n          reject(error);\r\n        }\r\n      }\r\n    };\r\n\r\n    // Start polling\r\n    checkStatus();\r\n  });\r\n};\r\n\r\n/**\r\n * Download generated timetable in specified format with CORS handling\r\n * @param {string} uploadId - The upload ID from the generation process\r\n * @param {string} format - Download format ('excel', 'pdf')\r\n * @returns {Promise<void>}\r\n */\r\nexport const downloadTimetable = async (uploadId, format) => {\r\n  try {\r\n    console.log(`Downloading timetable: ${uploadId} in ${format} format`);\r\n    const response = await makeRequestWithRetry(() =>\r\n      apiClient.post(\r\n        '/export-timetable',\r\n        {\r\n          upload_id: uploadId,\r\n          format: format.toLowerCase()\r\n        },\r\n        {\r\n          responseType: 'blob', // Important for file downloads\r\n        }\r\n      )\r\n    );\r\n\r\n    // Create blob link to download\r\n    const url = window.URL.createObjectURL(new Blob([response.data]));\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    \r\n    // Set filename based on format\r\n    const timestamp = new Date().toISOString().slice(0, 10);\r\n    const filename = `timetable_${timestamp}.${format === 'pdf' ? 'pdf' : 'xlsx'}`;\r\n    link.setAttribute('download', filename);\r\n    \r\n    // Trigger download\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    link.remove();\r\n    window.URL.revokeObjectURL(url);\r\n    \r\n  } catch (error) {\r\n    console.error('Download error:', error);\r\n    throw new Error(`Download failed: ${error.message}`);\r\n  }\r\n};\r\n\r\n/**\r\n * Get available time slots from server\r\n * @returns {Promise<Array>} Available time slots\r\n */\r\nexport const getTimeSlots = async () => {\r\n  try {\r\n    // Try to get time slots from API first\r\n    const response = await makeRequestWithRetry(() =>\r\n      apiClient.get('/timetable/timeslots')\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    // If API endpoint doesn't exist or fails, return default time slots\r\n    console.warn('Failed to fetch time slots from API, using defaults:', error.message);\r\n    return [\r\n      { start: '09:00', end: '10:00', label: '9:00 AM' },\r\n      { start: '10:00', end: '11:00', label: '10:00 AM' },\r\n      { start: '11:00', end: '12:00', label: '11:00 AM' },\r\n      { start: '12:00', end: '13:00', label: '12:00 PM' },\r\n      { start: '14:00', end: '15:00', label: '2:00 PM' },\r\n      { start: '15:00', end: '16:00', label: '3:00 PM' },\r\n      { start: '16:00', end: '17:00', label: '4:00 PM' },\r\n    ];\r\n  }\r\n};\r\n\r\n/**\r\n * Validate uploaded file on server\r\n * @param {string} fileId - ID of uploaded file\r\n * @returns {Promise<Object>} Validation results\r\n */\r\nexport const validateFile = async (fileId) => {\r\n  try {\r\n    const response = await makeRequestWithRetry(() =>\r\n      apiClient.post('/timetable/validate', { fileId })\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    throw new Error(`File validation failed: ${error.message}`);\r\n  }\r\n};\r\n\r\nexport default apiClient;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}